!function(e){"function"==typeof define&&define.amd?define("frontend",e):e()}(function(){"use strict";function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var e,d=window.jQuery,t=d.fn.select2.amd.require("select2/defaults");function i(){e=Date.now()}d.extend(t.defaults,{dropdownPosition:"auto"}),(t=d.fn.select2.amd.require("select2/dropdown/attachBody")).prototype._positionDropdown,t.prototype._positionDropdown=function(){var e=d(window),t=this.$dropdown.hasClass("select2-dropdown--above"),i=this.$dropdown.hasClass("select2-dropdown--below"),s=null,a=this.$container.offset(),n=(a.bottom=a.top+this.$container.outerHeight(!1),{height:this.$container.outerHeight(!1)});n.top=a.top,n.bottom=a.top+n.height;var o=this.$dropdown.outerHeight(!1),l=e.scrollTop(),e=e.scrollTop()+e.height(),l=l<a.top-o,e=e>a.bottom+o,a={left:a.left,top:n.bottom},r=this.$dropdownParent,r=(r="static"===r.css("position")?r.offsetParent():r).offset(),c=(a.top-=r.top,a.left-=r.left,this.options.get("dropdownPosition"));"above"===c||"below"===c?s=c:(t||i||(s="below"),e||!l||t?!l&&e&&t&&(s="below"):s="above"),("above"==s||t&&"below"!==s)&&(a.top=n.top-r.top-o),null!=s&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+s),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+s)),this.$dropdownContainer.css(a)},MyListing.Select_Config={lastSearch:{},diacritics:{},stripDiacritics:function(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return MyListing.Select_Config.diacritics[e]||e})}},MyListing.CustomSelect=function(e,t){var i,s,a,n,o=this;this.el=jQuery(e),this.el.length&&(this.el.addClass("mlduo-select"),a=this.el.data("placeholder")?this.el.data("placeholder"):this.el.attr("placeholder")?this.el.attr("placeholder"):CASE27.l10n.selectOption,this.args=jQuery.extend({sortable:!0,selected:[],multiple:this.el.prop("multiple"),required:this.el.prop("required"),placeholder:a,tags:!!this.el.data("create-tags"),ajax:!!this.el.data("mylisting-ajax"),dropdownPosition:this.el.data("dropdown-position")||"auto"},t),!0===this.args.ajax&&(i="object"===l(this.el.data("mylisting-ajax-params"))?this.el.data("mylisting-ajax-params"):{},s={url:CASE27.mylisting_ajax_url+"&action="+this.el.data("mylisting-ajax-url"),dataType:"json",delay:250,cache:!0,data:function(e){return i.page=e.page||1,i.search=e.term,i.security=CASE27.ajax_nonce,i},processResults:function(e,t){return{results:e.results||[],pagination:{more:e.more}}}}),a=this.el[0].parentNode.classList.contains("explore-filter"),this.select=jQuery(e).select2({width:"100%",minimumResultsForSearch:10,multiple:this.args.multiple,allowClear:!!a||!this.args.required,placeholder:this.args.placeholder,dropdownPosition:this.args.dropdownPosition,ajax:"object"===l(s)?s:null,tags:this.args.tags,escapeMarkup:function(e){return e},createTag:function(e){e=jQuery.trim(e.term);return""===e?null:{id:e,text:e}},language:{errorLoading:function(){return CASE27.l10n.errorLoading},loadingMore:function(){return CASE27.l10n.loadingMore},noResults:function(){return CASE27.l10n.noResults},removeAllItems:function(){return CASE27.l10n.removeAllItems},searching:function(e){return MyListing.Select_Config.lastSearch=e,CASE27.l10n.searching}}}),n=this.el.next(".select2-container").first("ul.select2-selection__rendered"),jQuery(n).on("click touchstart",function(e){jQuery(e.target).hasClass("select2-selection__choice__remove")&&e.stopImmediatePropagation()}),jQuery.fn.sortable&&n.sortable({placeholder:"ui-state-highlight",forcePlaceholderSize:!0,items:"li:not(.select2-search__field)",tolerance:"pointer",containment:"parent",stop:function(){jQuery(n.find(".select2-selection__choice").get().reverse()).each(function(){var e;jQuery(this).data("data")&&(e=jQuery(this).data("data").id,e=o.el.find('option[value="'+e+'"]')[0],o.el.prepend(e))})}}),this.select.on("change",this.fireChangeEvent.bind(this)))},MyListing.CustomSelect.prototype.fireChangeEvent=function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("select:change",!1,!0,{value:jQuery(e.currentTarget).val()}),this.el.get(0).dispatchEvent(t)},jQuery(function(s){function e(){s([".custom-select, .single-product .variations select","#buddypress div.item-list-tabs#subnav ul li select","#buddypress #notification-select","#wc_bookings_field_resource","#buddypress #messages-select","#buddypress form#whats-new-form #whats-new-options select",".settings.privacy-settings #buddypress #item-body > form > p select",".woocommerce-ordering select",".c27-submit-listing-form select:not(.ignore-custom-select)",".ml-admin-listing-form select:not(.ignore-custom-select)"].join(", ")).each(function(e,t){new MyListing.CustomSelect(t)})}s.fn.select2.amd.require(["select2/diacritics"],function(e){return MyListing.Select_Config.diacritics=e}),s.fn.select2.defaults.defaults&&(s.fn.select2.defaults.defaults.sorter=function(e){var i;return""===s.trim(MyListing.Select_Config.lastSearch.term)||(e=e.slice(0),i=MyListing.Select_Config.lastSearch.term||"",i=MyListing.Select_Config.stripDiacritics(i).toUpperCase(),e.sort(function(e,t){e=MyListing.Select_Config.stripDiacritics(e.text).toUpperCase(),t=MyListing.Select_Config.stripDiacritics(t.text).toUpperCase();return e.indexOf(i)-t.indexOf(i)})),e}),e(),s(document).on("mylisting:refresh-scripts",function(){e()}),s(".repeater").each(function(e,t){s(t).repeater({initEmpty:!0,show:function(){s(this).show(),s(this).find("select").select2({minimumResultsForSearch:0})}}).setList(s(t).data("list"))})}),MyListing.TermHierarchy=function(e){this.input=jQuery(e),this.el=this.input.parent(),this.input.length&&this.el.hasClass("cts-term-hierarchy")&&(this.ajax_params=this.input.data("mylisting-ajax-params"),this.placeholder=this.input.data("placeholder"),this.selected=this.input.data("selected")||[],this.term_value="slug"===this.ajax_params["term-value"]?"slug":"id",this.label=this.el.find("> label"),this.originalLabel=this.label.length?this.label.html():"",this.labelTemplate='<span class="go-back-btn" data-index="%index%"><i class="mi keyboard_backspace"></i> %label%</span>',this.template="alternate"===this.input.data("template")?"alternate":"default",this.el.addClass("tpl-"+this.template),this.selected.length?this.handleDefaultValue():this.addChildSelect({index:0,select:null}),this.label.on("click",function(){var e=this.label.find(".go-back-btn");e.length&&(e=parseInt(e.data("index"),10),this.el.find(".select-wrapper.term-select-"+(e-1)+" .select2-selection__clear").mousedown())}.bind(this)),this.input.on("change",this.fireChangeEvent.bind(this)),this.addWrapperClasses())},MyListing.TermHierarchy.prototype.maybeAddChildSelect=function(t){var i=this,e=".term-select.term-select-"+t.index+", .term-select.term-select-"+t.index+" ~ .term-select";this.el.find(e).find("select").select2("destroy"),this.el.find(e).remove(),t.select.val()&&((e=jQuery.extend({},t.select.data("mylisting-ajax-params"),{page:1,security:CASE27.ajax_nonce,search:""}))["slug"===this.term_value?"parent":"parent_id"]=t.select.val(),this.el.addClass("cts-terms-loading"),jQuery.ajax({url:CASE27.mylisting_ajax_url+"&action=mylisting_list_terms",type:"GET",dataType:"json",data:e,beforeSend:function(e){t.select.data("last_request")&&t.select.data("last_request").abort(),t.select.data("last_request",e)},success:function(e){i.el.removeClass("cts-terms-loading"),"object"===l(e)&&e.results&&e.results.length&&i.addChildSelect(t)}}))},MyListing.TermHierarchy.prototype.addChildSelect=function(i){var e,s,t=jQuery('<div class="select-wrapper term-select term-select-'+i.index+'">            <select class="custom-select term-select" data-mylisting-ajax="true" data-mylisting-ajax-url="mylisting_list_terms">                <option></option>            </select>        </div>'),a=("alternate"===this.template&&t.find("select").data("dropdown-position","below"),0===i.index?(s=this.originalLabel,e=this.placeholder):(a=i.select.find('option[value="'+i.select.val()+'"]').text(),e=CASE27.l10n.all_in_category.replace("%s",a),s=this.labelTemplate.replace("%index%",i.index).replace("%label%",a)),this.updateLabel(s),jQuery.extend({},this.ajax_params)),a=(a["slug"===this.term_value?"parent":"parent_id"]=0===i.index?0:i.select.val(),t.find("select").data("mylisting-ajax-params",a).attr("placeholder",e),this.el.append(t),new MyListing.CustomSelect(t.find("select")),this.el.parents(".field-type-term-select"));return 0!==i.index&&a.length&&this.input.val("").trigger("change"),t.find("select").on("select:change",function(e){var t=i.select?i.select.val():"";this.input.val(e.detail.value||t).trigger("change"),this.updateLabel(s),this.maybeAddChildSelect({index:i.index+1,select:jQuery(e.target)})}.bind(this)),t},MyListing.TermHierarchy.prototype.handleDefaultValue=function(){var i=0,s=null,e=(this.selected.forEach(function(e){var t=this.addChildSelect({index:i,select:s});(s=t.find("select")).append('<option value="'+e.value+'">'+e.label+"</option>").val(e.value),i++}.bind(this)),s.trigger("change"),this.selected[this.selected.length-1]);this.updateLabel(this.labelTemplate.replace("%index%",this.selected.length-1).replace("%label%",e.label)),this.input.val(e.value).trigger("change")},MyListing.TermHierarchy.prototype.fireChangeEvent=function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("termhierarchy:change",!1,!0,{value:this.input.val()}),this.input.get(0).dispatchEvent(t),this.addWrapperClasses()},MyListing.TermHierarchy.prototype.updateLabel=function(e){"alternate"===this.template&&this.label.length&&this.label.html(e+'<div class="spin-box"></div>')},MyListing.TermHierarchy.prototype.addWrapperClasses=function(){var e=this.input.val().trim();this.el[e?"addClass":"removeClass"]("cts-term-filled")},jQuery(function(i){i(".term-hierarchy-input").each(function(e,t){new MyListing.TermHierarchy(i(this))})}),document.addEventListener("DOMContentLoaded",function(){jQuery(".cts-carousel").each(function(e,t){function i(){"rtl"===jQuery("html").attr("dir")?(10<t.scrollWidth-t.offsetWidth+t.scrollLeft?a.classList.add("cts-show"):a.classList.remove("cts-show"),t.scrollLeft<-10?s.classList.add("cts-show"):s.classList.remove("cts-show")):(10<t.scrollWidth-t.offsetWidth-t.scrollLeft?a.classList.add("cts-show"):a.classList.remove("cts-show"),10<t.scrollLeft?s.classList.add("cts-show"):s.classList.remove("cts-show"))}var s=t.querySelector(".cts-prev"),a=t.querySelector(".cts-next");t.addEventListener("scroll",MyListing.Helpers.debounce(i,20)),new ResizeSensor(t,MyListing.Helpers.debounce(i,100)),i()})}),jQuery(document).ready(function(e){e(".main-loader").addClass("loader-hidden"),setTimeout(function(){e(".main-loader").hide()},600),e("body").addClass("c27-site-loaded")}),e=Date.now(),document.onmousemove=i,document.onkeydown=i,document.onmousedown=i,document.ontouchstart=i,document.onscroll=i,MyListing.Helpers.getLastActivity=function(){return Date.now()-e},jQuery.ajaxPrefilter(function(e,t,i){t&&t.data&&1===t.data.no_idle&&1e4<=MyListing.Helpers.getLastActivity()&&i.abort()}),MyListing.Handlers.Bookmark_Button=function(e,t){e.preventDefault();t=jQuery(t);if(!jQuery("body").hasClass("logged-in"))return window.location.href=CASE27.login_url;t.hasClass("bookmarking")||(e=CASE27.mylisting_ajax_url+"&action=bookmark_listing",t.addClass("bookmarking").toggleClass("bookmarked"),t.find(".action-label").html(t.hasClass("bookmarked")?t.data("active-label"):t.data("label")),jQuery.get(e,{listing_id:t.data("listing-id")},function(e){t.removeClass("bookmarking")}))},jQuery(document).ready(window.case27_ready_script=function(i){var e,t;i(document).trigger("mylisting:refresh-scripts"),"string"==typeof MyListing_Moment_Locale&&MyListing_Moment_Locale.length&&moment.locale(MyListing_Moment_Locale),e=null!=navigator.userAgent.match(/Android/i),t=null!=navigator.userAgent.match(/iPhone|iPad|iPod/i),e&&i("body").addClass("smartphoneuser"),t&&i("body").addClass("smartphoneuser iOSUser"),jQuery(".c27-quick-view-modal").on("hidden.bs.modal",function(e){i(".c27-quick-view-modal .container").css("height","auto")}),i("body").on("click",".c27-toggle-quick-view-modal",function(e){e.preventDefault(),i(".c27-quick-view-modal").modal("show"),i(".c27-quick-view-modal").addClass("loading-modal"),i.ajax({url:CASE27.mylisting_ajax_url+"&action=get_listing_quick_view&security="+CASE27.ajax_nonce,type:"GET",dataType:"json",data:{listing_id:i(this).data("id")},success:function(e){i(".c27-quick-view-modal").removeClass("loading-modal"),i(".c27-quick-view-modal .modal-content").html(e.html),i(".c27-quick-view-modal .c27-map").css("height",i(".c27-quick-view-modal .modal-content").height()),i(window).trigger("resize"),setTimeout(function(){new MyListing.Maps.Map(i(".c27-quick-view-modal .c27-map").get(0))},10),MyListing.BackgroundCarousel(),i(".c27-quick-view-modal .container").each(function(e,t){i(t).height()%2!=0&&i(t).height(i(t).height()+1)});e=i(".c27-quick-view-modal .modal-content").height();i(".c27-quick-view-modal .block-map").css("height",e)}})}),i("body").on("click",".c27-display-button",function(){var e,t=i(this);t.hasClass("loading")||t.hasClass("loaded")||(e={listing_id:i(this).data("listing-id"),field_id:i(this).data("field-id")},t.addClass("loading"),i.post(CASE27.mylisting_ajax_url+"&action=display_contact_info&security="+CASE27.ajax_nonce,e,function(e){t.removeClass("loading").addClass("loaded"),e.value&&t.html(e.value)}))}),i("#ml-messages-modal, #quicksearch-mobile-modal").on("shown.bs.modal",function(){i("body").addClass("disable-scroll")}).on("hidden.bs.modal",function(){i("body").removeClass("disable-scroll")}),i(".c27-add-product-form input#_virtual").change(function(e){i(".c27-add-product-form .product_shipping_class_wrapper")["checked"==i(this).attr("checked")?"hide":"show"]()}).change(),i(".c27-add-product-form input#_sale_price").keyup(function(e){i(".c27-add-product-form ._sale_price_dates_from__wrapper")[i(this).val()?"show":"hide"](),i(".c27-add-product-form ._sale_price_dates_to__wrapper")[i(this).val()?"show":"hide"]()}).keyup(),i(".c27-add-product-form input#_manage_stock").change(function(e){i(".c27-add-product-form ._stock__wrapper")["checked"==i(this).attr("checked")?"show":"hide"](),i(".c27-add-product-form ._backorders__wrapper")["checked"==i(this).attr("checked")?"show":"hide"]()}).change(),i("#user-cart-menu").length&&i(document.body).one("wc_fragments_loaded",function(e){i("#user-cart-menu").addClass("user-cart-updated")}),i(".modal-27").on("show.bs.modal",function(){i(this).addClass("show-modal")}),i(".modal-27").on("hidden.bs.modal",function(){i(this).removeClass("show-modal")}),i(".modal-27").on("hide.bs.modal",function(e){var t=i(this);t.hasClass("in")?(e.preventDefault(),t.removeClass("in"),i("body").addClass("modal-closing"),setTimeout(function(){t.modal("hide")},200)):(i("body").removeClass("modal-closing"),i("body").addClass("modal-closed"),setTimeout(function(){return i("body").removeClass("modal-closed")},100))})}),MyListing.Dialog=function(e){this.visible=!1,this.args=jQuery.extend({message:"",status:"info",dismissable:!0,spinner:!1,timeout:3e3},e),this.show(),this.setTimeout()},MyListing.Dialog.prototype.draw=function(){this.template=jQuery(jQuery("#mylisting-dialog-template").text()),this.template.addClass(this.args.status),this.insertContent(),this.template.appendTo("body")},MyListing.Dialog.prototype.refresh=function(e){this.args=jQuery.extend(this.args,e),this.setTimeout(),this.insertContent()},MyListing.Dialog.prototype.insertContent=function(){var t=this;this.template.find(".mylisting-dialog--message").html(this.args.message),this.template.find(".mylisting-dialog--dismiss")[this.args.dismissable?"removeClass":"addClass"]("hide").click(function(e){e.preventDefault(),t.hide()}),this.template.find(".mylisting-dialog--loading")[this.args.spinner?"removeClass":"addClass"]("hide")},MyListing.Dialog.prototype.setTimeout=function(){var e=this;e.timeout&&clearTimeout(e.timeout),!isNaN(e.args.timeout)&&0<e.args.timeout&&(e.timeout=setTimeout(function(){e.hide()},e.args.timeout))},MyListing.Dialog.prototype.show=function(){var e=this;e.draw(),setTimeout(function(){e.template.addClass("slide-in"),e.visible=!0},15)},MyListing.Dialog.prototype.hide=function(){var e=this;e.template.removeClass("slide-in").addClass("slide-out"),setTimeout(function(){e.template.remove(),e.visible=!1},250)}});
