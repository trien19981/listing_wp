!function(t){"function"==typeof define&&define.amd?define("vendor",t):t()}(function(){"use strict";function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e=window,n=function(r){var i,o,a,s,u,p,f,l;function t(t){this.$inputor=t}function e(t){this.$inputor=t,this.domInputor=this.$inputor[0]}function n(t){this.$inputor=t,this.domInputor=this.$inputor[0]}n.prototype.setPos=function(t){var u,l,c,h;return(h=f.getSelection())&&(c=0,l=!1,(u=function(t,e){for(var n,i,r=e.childNodes,o=[],a=0,s=r.length;a<s&&(n=r[a],!l);a++)if(3===n.nodeType){if(c+n.length>=t){l=!0,(i=p.createRange()).setStart(n,t-c),h.removeAllRanges(),h.addRange(i);break}o.push(c+=n.length)}else o.push(u(t,n));return o})(t,this.domInputor)),this.domInputor},n.prototype.getIEPosition=function(){return this.getPosition()},n.prototype.getPosition=function(){var t=this.getOffset(),e=this.$inputor.offset();return t.left-=e.left,t.top-=e.top,t},n.prototype.getOldIEPos=function(){var t=p.selection.createRange(),e=p.body.createTextRange();return e.moveToElementText(this.domInputor),e.setEndPoint("EndToEnd",t),e.text.length},n.prototype.getPos=function(){var t,e;return(e=this.range())?((t=e.cloneRange()).selectNodeContents(this.domInputor),t.setEnd(e.endContainer,e.endOffset),e=t.toString().length,t.detach(),e):p.selection?this.getOldIEPos():void 0},n.prototype.getOldIEOffset=function(){var t=p.selection.createRange().duplicate();return t.moveStart("character",-1),{height:(t=t.getBoundingClientRect()).bottom-t.top,left:t.left,top:t.top}},n.prototype.getOffset=function(){var t,e,n,i;return f.getSelection&&(i=this.range())?(0<i.endOffset-1&&i.endContainer!==this.domInputor&&((t=i.cloneRange()).setStart(i.endContainer,i.endOffset-1),t.setEnd(i.endContainer,i.endOffset),e={height:(n=t.getBoundingClientRect()).height,left:n.left+n.width,top:n.top},t.detach()),e&&0!==(null!=e?e.height:void 0)||(t=i.cloneRange(),i=r(p.createTextNode("|")),t.insertNode(i[0]),t.selectNode(i[0]),e={height:(n=t.getBoundingClientRect()).height,left:n.left,top:n.top},i.remove(),t.detach())):p.selection&&(e=this.getOldIEOffset()),e&&(e.top+=r(f).scrollTop(),e.left+=r(f).scrollLeft()),e},n.prototype.range=function(){var t;if(f.getSelection)return 0<(t=f.getSelection()).rangeCount?t.getRangeAt(0):null},i=n,e.prototype.getIEPos=function(){var t,e,n=this.domInputor,i=p.selection.createRange(),r=0;return i&&i.parentElement()===n&&(t=n.value.replace(/\r\n/g,"\n").length,(e=n.createTextRange()).moveToBookmark(i.getBookmark()),(i=n.createTextRange()).collapse(!1),r=-1<e.compareEndPoints("StartToEnd",i)?t:-e.moveStart("character",-t)),r},e.prototype.getPos=function(){return p.selection?this.getIEPos():this.domInputor.selectionStart},e.prototype.setPos=function(t){var e,n=this.domInputor;return p.selection?((e=n.createTextRange()).move("character",t),e.select()):n.setSelectionRange&&n.setSelectionRange(t,t),n},e.prototype.getIEOffset=function(t){var e=this.domInputor.createTextRange();return t=t||this.getPos(),e.move("character",t),{left:e.boundingLeft,top:e.boundingTop,height:e.boundingHeight}},e.prototype.getOffset=function(t){var e,n=this.$inputor;return p.selection?((e=this.getIEOffset(t)).top+=r(f).scrollTop()+n.scrollTop(),e.left+=r(f).scrollLeft()+n.scrollLeft(),e):(e=n.offset(),t=this.getPosition(t),{left:e.left+t.left-n.scrollLeft(),top:e.top+t.top-n.scrollTop(),height:t.height})},e.prototype.getPosition=function(t){var e,n=this.$inputor,i=function(t){return t=t.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>"),t=/firefox/i.test(navigator.userAgent)?t.replace(/\s/g,"&nbsp;"):t};return void 0===t&&(t=this.getPos()),e=n.val().slice(0,t),t=n.val().slice(t),e="<span style='position: relative; display: inline;'>"+i(e)+"</span>",e=(e+="<span id='caret' style='position: relative; display: inline;'>|</span>")+("<span style='position: relative; display: inline;'>"+i(t)+"</span>"),new a(n).create(e).rect()},e.prototype.getIEPosition=function(t){var t=this.getIEOffset(t),e=this.$inputor.offset();return{left:t.left-e.left,top:t.top-e.top,height:t.height}},o=e,t.prototype.css_attr=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"],t.prototype.mirrorCss=function(){var n=this,i={position:"absolute",left:-9999,top:0,zIndex:-2e4};return"TEXTAREA"===this.$inputor.prop("tagName")&&this.css_attr.push("width"),r.each(this.css_attr,function(t,e){return i[e]=n.$inputor.css(e)}),i},t.prototype.create=function(t){return this.$mirror=r("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(t),this.$inputor.after(this.$mirror),this},t.prototype.rect=function(){var t=this.$mirror.find("#caret"),e=t.position(),e={left:e.left,top:e.top,height:t.height()};return this.$mirror.remove(),e},a=t,s={contentEditable:function(t){return!(!t[0].contentEditable||"true"!==t[0].contentEditable)}},u={pos:function(t){return t||0===t?this.setPos(t):this.getPos()},position:function(t){return p.selection?this.getIEPosition(t):this.getPosition(t)},offset:function(t){return this.getOffset(t)}},f=p=null,l=function(t){return p=(t=null!=t?t.iframe:void 0)?(f=t.contentWindow,t.contentDocument||f.document):(f=window,document)},r.fn.caret=function(t,e,n){return u[t]?(r.isPlainObject(e)?(l(e),e=void 0):l(n),n=new(s.contentEditable(this)?i:o)(this),u[t].apply(n,[e])):r.error("Method "+t+" does not exist on jQuery.caret")},r.fn.caret.EditableCaret=i,r.fn.caret.InputCaret=o,r.fn.caret.Utils=s,r.fn.caret.apis=u},"function"==typeof define&&define.amd?define(["jquery"],function(t){return e.returnExportsGlobal=n(t)}):"object"==("undefined"==typeof exports?"undefined":T(exports))?module.exports=n(require("jquery")):n(jQuery),window,t=function(s){var n,a;function t(t){this.currentFlag=null,this.controllers={},this.aliasMaps={},this.$inputor=s(t),this.setupRootElement(),this.listen()}a={ESC:27,TAB:9,ENTER:13,CTRL:17,A:65,P:80,N:78,LEFT:37,UP:38,RIGHT:39,DOWN:40,BACKSPACE:8,SPACE:32},n={beforeSave:function(t){return r.arrayToDefaultHash(t)},matcher:function(t,e,n,i){var r;return t=t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),n&&(t="(?:^|\\s)"+t),n=decodeURI("%C3%80"),r=decodeURI("%C3%BF"),(n=new RegExp(t+"([A-Za-z"+n+"-"+r+"0-9_"+(i?" ":"")+"'.+-]*)$|"+t+"([^\\x00-\\xff]*)$","gi").exec(e))?n[2]||n[1]:null},filter:function(t,e,n){for(var i,r=[],o=0,a=e.length;o<a;o++)i=e[o],~new String(i[n]).toLowerCase().indexOf(t.toLowerCase())&&r.push(i);return r},remoteFilter:null,sorter:function(t,e,n){var i,r,o,a;if(!t)return e;for(i=[],r=0,a=e.length;r<a;r++)(o=e[r]).atwho_order=new String(o[n]).toLowerCase().indexOf(t.toLowerCase()),-1<o.atwho_order&&i.push(o);return i.sort(function(t,e){return t.atwho_order-e.atwho_order})},tplEval:function(t,i){var e=t;try{return(e="string"!=typeof t?t(i):e).replace(/\$\{([^\}]*)\}/g,function(t,e,n){return i[e]})}catch(t){return""}},highlighter:function(t,e){return e?(e=new RegExp(">\\s*([^<]*?)("+e.replace("+","\\+")+")([^<]*)\\s*<","ig"),t.replace(e,function(t,e,n,i){return"> "+e+"<strong>"+n+"</strong>"+i+" <"})):t},beforeInsert:function(t,e,n){return t},beforeReposition:function(t){return t},afterMatchFailed:function(t,e){}},t.prototype.createContainer=function(t){var e;return null!=(e=this.$el)&&e.remove(),s(t.body).append(this.$el=s("<div class='atwho-container'></div>"))},t.prototype.setupRootElement=function(e,t){if(null==t&&(t=!1),e)this.window=e.contentWindow,this.document=e.contentDocument||this.window.document,this.iframe=e;else{this.document=this.$inputor[0].ownerDocument,this.window=this.document.defaultView||this.document.parentWindow;try{this.iframe=this.window.frameElement}catch(t){if(e=t,this.iframe=null,s.fn.atwho.debug)throw new Error("iframe auto-discovery is failed.\nPlease use `setIframe` to set the target iframe manually.\n"+e)}}return this.createContainer((this.iframeAsRoot=t)?this.document:document)},t.prototype.controller=function(t){var e,n,i,r;if(this.aliasMaps[t])n=this.controllers[this.aliasMaps[t]];else for(i in r=this.controllers)if(e=r[i],i===t){n=e;break}return n||this.controllers[this.currentFlag]},t.prototype.setContextFor=function(t){return this.currentFlag=t,this},t.prototype.reg=function(t,e){var n=(n=this.controllers)[t]||(n[t]=new(this.$inputor.is("[contentEditable]")?c:d)(this,t));return e.alias&&(this.aliasMaps[e.alias]=t),n.init(e),this},t.prototype.listen=function(){return this.$inputor.on("compositionstart",(s=this,function(t){var e;return null!=(e=s.controller())&&e.view.hide(),s.isComposing=!0,null})).on("compositionend",(a=this,function(t){return a.isComposing=!1,setTimeout(function(t){return a.dispatch(t)}),null})).on("keyup.atwhoInner",(o=this,function(t){return o.onKeyup(t)})).on("keydown.atwhoInner",(i=this,function(t){return i.onKeydown(t)})).on("blur.atwhoInner",(n=this,function(t){var e;return(e=n.controller())?(e.expectedQueryCBId=null,e.view.hide(t,e.getOpt("displayTimeout"))):void 0})).on("click.atwhoInner",(e=this,function(t){return e.dispatch(t)})).on("scroll.atwhoInner",(r=this,function(){var i=r.$inputor.scrollTop();return function(t){var e,n=t.target.scrollTop;return i!==n&&null!=(e=r.controller())&&e.view.hide(t),i=n,!0}}()));var r,e,n,i,o,a,s},t.prototype.shutdown=function(){var t,e,n=this.controllers;for(t in n)e=n[t],e.destroy(),delete this.controllers[t];return this.$inputor.off(".atwhoInner"),this.$el.remove()},t.prototype.dispatch=function(t){var e,n,i=this.controllers,r=[];for(e in i)n=i[e],r.push(n.lookUp(t));return r},t.prototype.onKeyup=function(t){var e;switch(t.keyCode){case a.ESC:t.preventDefault(),null!=(e=this.controller())&&e.view.hide();break;case a.DOWN:case a.UP:case a.CTRL:case a.ENTER:s.noop();break;case a.P:case a.N:t.ctrlKey||this.dispatch(t);break;default:this.dispatch(t)}},t.prototype.onKeydown=function(t){var e,n=null!=(e=this.controller())?e.view:void 0;if(n&&n.visible())switch(t.keyCode){case a.ESC:t.preventDefault(),n.hide(t);break;case a.UP:t.preventDefault(),n.prev();break;case a.DOWN:t.preventDefault(),n.next();break;case a.P:t.ctrlKey&&(t.preventDefault(),n.prev());break;case a.N:t.ctrlKey&&(t.preventDefault(),n.next());break;case a.TAB:case a.ENTER:case a.SPACE:!n.visible()||!this.controller().getOpt("spaceSelectsMatch")&&t.keyCode===a.SPACE||!this.controller().getOpt("tabSelectsMatch")&&t.keyCode===a.TAB||(n.highlighted()?(t.preventDefault(),n.choose(t)):n.hide(t));break;default:s.noop()}};var o=t,i=[].slice;function e(t,e){this.app=t,this.at=e,this.$inputor=this.app.$inputor,this.id=this.$inputor[0].id||this.uid(),this.expectedQueryCBId=null,this.setting=null,this.query=null,this.pos=0,this.range=null,0===(this.$el=s("#atwho-ground-"+this.id,this.app.$el)).length&&this.app.$el.append(this.$el=s("<div id='atwho-ground-"+this.id+"'></div>")),this.model=new h(this),this.view=new p(this)}e.prototype.uid=function(){return(Math.random().toString(16)+"000000000").substr(2,8)+(new Date).getTime()},e.prototype.init=function(t){return this.setting=s.extend({},this.setting||s.fn.atwho.default,t),this.view.init(),this.model.reload(this.setting.data)},e.prototype.destroy=function(){return this.trigger("beforeDestroy"),this.model.destroy(),this.view.destroy(),this.$el.remove()},e.prototype.callDefault=function(){var e=arguments[0],t=2<=arguments.length?i.call(arguments,1):[];try{return n[e].apply(this,t)}catch(t){return s.error(t+" Or maybe At.js doesn't have function "+e)}},e.prototype.trigger=function(t,e){var n;return(e=null==e?[]:e).push(this),n=this.getOpt("alias"),this.$inputor.trigger(n?t+"-"+n+".atwho":t+".atwho",e)},e.prototype.callbacks=function(t){return this.getOpt("callbacks")[t]||n[t]},e.prototype.getOpt=function(t,e){try{return this.setting[t]}catch(t){return null}},e.prototype.insertContentFor=function(t){var e=this.getOpt("insertTpl"),t=s.extend({},t.data("item-data"),{"atwho-at":this.at});return this.callbacks("tplEval").call(this,e,t,"onInsert")},e.prototype.renderView=function(t){var e=this.getOpt("searchKey");return t=this.callbacks("sorter").call(this,this.query.text,t.slice(0,1001),e),this.view.render(t.slice(0,this.getOpt("limit")))},e.arrayToDefaultHash=function(t){var e,n,i,r;if(!s.isArray(t))return t;for(r=[],e=0,i=t.length;e<i;e++)n=t[e],s.isPlainObject(n)?r.push(n):r.push({name:n});return r},e.prototype.lookUp=function(t){var e;if((!t||"click"!==t.type||this.getOpt("lookUpOnClick"))&&(!this.getOpt("suspendOnComposing")||!this.app.isComposing))return(t=this.catchQuery(t))?(this.app.setContextFor(this.at),(e=this.getOpt("delay"))?this._delayLookUp(t,e):this._lookUp(t)):this.expectedQueryCBId=null,t},e.prototype._delayLookUp=function(t,e){var n,i,r=Date.now?Date.now():(new Date).getTime();return this.previousCallTime||(this.previousCallTime=r),0<(n=e-(r-this.previousCallTime))&&n<e?(this.previousCallTime=r,this._stopDelayedCall(),this.delayedCallTimeout=setTimeout((i=this,function(){return i.previousCallTime=0,i.delayedCallTimeout=null,i._lookUp(t)}),e)):(this._stopDelayedCall(),this.previousCallTime!==r&&(this.previousCallTime=0),this._lookUp(t))},e.prototype._stopDelayedCall=function(){return this.delayedCallTimeout?(clearTimeout(this.delayedCallTimeout),this.delayedCallTimeout=null):void 0},e.prototype._generateQueryCBId=function(){return{}},e.prototype._lookUp=function(t){var e=function(t,e){return t===this.expectedQueryCBId?e&&0<e.length?this.renderView(this.constructor.arrayToDefaultHash(e)):this.view.hide():void 0};return this.expectedQueryCBId=this._generateQueryCBId(),this.model.query(t.text,s.proxy(e,this,this.expectedQueryCBId))};var r=e,u={}.hasOwnProperty;function l(){return l.__super__.constructor.apply(this,arguments)}(function(t,e){function n(){this.constructor=t}for(var i in e)u.call(e,i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype})(l,r),l.prototype.catchQuery=function(){var t=this.$inputor.val(),e=this.$inputor.caret("pos",{iframe:this.app.iframe}),t=t.slice(0,e),t=this.callbacks("matcher").call(this,this.at,t,this.getOpt("startWithSpace"),this.getOpt("acceptSpaceBar")),n="string"==typeof t;return n&&t.length<this.getOpt("minLen",0)?void 0:(n&&t.length<=this.getOpt("maxLen",20)?(e=(n=e-t.length)+t.length,this.pos=n,this.trigger("matched",[this.at,(t={text:t,headPos:n,endPos:e}).text])):(t=null,this.view.hide()),this.query=t)},l.prototype.rect=function(){var t,e;if(t=this.$inputor.caret("offset",this.pos-1,{iframe:this.app.iframe}))return this.app.iframe&&!this.app.iframeAsRoot&&(e=s(this.app.iframe).offset(),t.left+=e.left,t.top+=e.top),e=this.app.document.selection?0:2,{left:t.left,top:t.top,bottom:t.top+t.height+e}},l.prototype.insert=function(t,e){var n=this.$inputor,i=n.val(),r=i.slice(0,Math.max(this.query.headPos-this.at.length,0)),o=""===(o=this.getOpt("suffix"))?o:o||" ",o=""+r+(t+=o)+i.slice(this.query.endPos||0);return n.val(o),n.caret("pos",r.length+t.length,{iframe:this.app.iframe}),n.is(":focus")||n.focus(),n.change()};var c,h,p,f,d=l,u={}.hasOwnProperty;function g(){return g.__super__.constructor.apply(this,arguments)}function v(t){this.context=t,this.at=this.context.at,this.storage=this.context.$inputor}function y(t){this.context=t,this.$el=s("<div class='atwho-view'><ul class='atwho-view-ul'></ul></div>"),this.$elUl=this.$el.children(),this.timeoutID=null,this.context.$el.append(this.$el),this.bindEvent()}(function(t,e){function n(){this.constructor=t}for(var i in e)u.call(e,i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype})(g,r),g.prototype._getRange=function(){var t=this.app.window.getSelection();return 0<t.rangeCount?t.getRangeAt(0):void 0},g.prototype._setRange=function(t,e,n){return(n=null==n?this._getRange():n)&&e?(e=s(e)[0],"after"===t?(n.setEndAfter(e),n.setStartAfter(e)):(n.setEndBefore(e),n.setStartBefore(e)),n.collapse(!1),this._clearRange(n)):void 0},g.prototype._clearRange=function(t){var e;return null==t&&(t=this._getRange()),e=this.app.window.getSelection(),null==this.ctrl_a_pressed?(e.removeAllRanges(),e.addRange(t)):void 0},g.prototype._movingEvent=function(t){return"click"===t.type||(t=t.which)===a.RIGHT||t===a.LEFT||t===a.UP||t===a.DOWN},g.prototype._unwrap=function(t){var e;return(e=(t=s(t).unwrap().get(0)).nextSibling)&&e.nodeValue&&(t.nodeValue+=e.nodeValue,s(e).remove()),t},g.prototype.catchQuery=function(t){var e,n,i,r,o;if((o=this._getRange())&&o.collapsed){if(t.which!==a.ENTER){if(/firefox/i.test(navigator.userAgent)){if(s(o.startContainer).is(this.$inputor))return void this._clearRange();t.which===a.BACKSPACE&&o.startContainer.nodeType===document.ELEMENT_NODE&&0<=(r=o.startOffset-1)?((n=o.cloneRange()).setStart(o.startContainer,r),s(n.cloneContents()).contents().last().is(".atwho-inserted")&&(r=s(o.startContainer).contents().get(r),this._setRange("after",s(r).contents().last()))):t.which===a.LEFT&&o.startContainer.nodeType===document.TEXT_NODE&&(r=s(o.startContainer.previousSibling)).is(".atwho-inserted")&&0===o.startOffset&&this._setRange("after",r.contents().last())}if(s(o.startContainer).closest(".atwho-inserted").addClass("atwho-query").siblings().removeClass("atwho-query"),0<(e=s(".atwho-query",this.app.document)).length&&e.is(":empty")&&0===e.text().length&&e.remove(),this._movingEvent(t)||e.removeClass("atwho-inserted"),0<e.length)switch(t.which){case a.LEFT:return this._setRange("before",e.get(0),o),void e.removeClass("atwho-query");case a.RIGHT:return this._setRange("after",e.get(0).nextSibling,o),void e.removeClass("atwho-query")}return 0<e.length&&(r=e.attr("data-atwho-at-query"))&&(e.empty().html(r).attr("data-atwho-at-query",null),this._setRange("after",e.get(0),o)),(n=o.cloneRange()).setStart(o.startContainer,0),n="string"==typeof(r=this.callbacks("matcher").call(this,this.at,n.toString(),this.getOpt("startWithSpace"),this.getOpt("acceptSpaceBar"))),0===e.length&&n&&0<=(i=o.startOffset-this.at.length-r.length)&&(o.setStart(o.startContainer,i),e=s("<span/>",this.app.document).attr(this.getOpt("editableAtwhoQueryAttrs")).addClass("atwho-query"),o.surroundContents(e.get(0)),i=e.contents().last().get(0))&&(/firefox/i.test(navigator.userAgent)?(o.setStart(i,i.length),o.setEnd(i,i.length),this._clearRange(o)):this._setRange("after",i,o)),n&&r.length<this.getOpt("minLen",0)?void 0:n&&r.length<=this.getOpt("maxLen",20)?(this.trigger("matched",[this.at,(i={text:r,el:e}).text]),this.query=i):(this.view.hide(),this.query={el:e},0<=e.text().indexOf(this.at)&&(this._movingEvent(t)&&e.hasClass("atwho-inserted")?e.removeClass("atwho-query"):!1!==this.callbacks("afterMatchFailed").call(this,this.at,e)&&this._setRange("after",this._unwrap(e.text(e.text()).contents().first()))),null)}(e=s(o.startContainer).closest(".atwho-query")).contents().unwrap(),e.is(":empty")&&e.remove(),(e=s(".atwho-query",this.app.document)).text(e.text()).contents().last().unwrap(),this._clearRange()}},g.prototype.rect=function(){var t,e=this.query.el.offset();return e&&this.query.el[0].getClientRects().length?(this.app.iframe&&!this.app.iframeAsRoot&&(t=s(this.app.iframe).offset(),e.left+=t.left-this.$inputor.scrollLeft(),e.top+=t.top-this.$inputor.scrollTop()),e.bottom=e.top+this.query.el.height(),e):void 0},g.prototype.insert=function(t,e){var n;return this.$inputor.is(":focus")||this.$inputor.focus(),(n=this.getOpt("functionOverrides")).insert?n.insert.call(this,t,e):(n=""===(n=this.getOpt("suffix"))?n:n||" ",e=e.data("item-data"),this.query.el.removeClass("atwho-query").addClass("atwho-inserted").html(t).attr("data-atwho-at-query",""+e["atwho-at"]+this.query.text).attr("contenteditable","false"),(t=this._getRange())&&(this.query.el.length&&t.setEndAfter(this.query.el[0]),t.collapse(!1),t.insertNode(e=this.app.document.createTextNode(""+n)),this._setRange("after",e,t)),this.$inputor.is(":focus")||this.$inputor.focus(),this.$inputor.change())},c=g,v.prototype.destroy=function(){return this.storage.data(this.at,null)},v.prototype.saved=function(){return 0<this.fetch()},v.prototype.query=function(t,e){var n=this.fetch(),i=this.context.getOpt("searchKey");return n=this.context.callbacks("filter").call(this.context,t,n,i)||[],i=this.context.callbacks("remoteFilter"),0<n.length||!i&&0===n.length?e(n):i.call(this.context,t,e)},v.prototype.fetch=function(){return this.storage.data(this.at)||[]},v.prototype.save=function(t){return this.storage.data(this.at,this.context.callbacks("beforeSave").call(this.context,t||[]))},v.prototype.load=function(t){return!this.saved()&&t?this._load(t):void 0},v.prototype.reload=function(t){return this._load(t)},v.prototype._load=function(t){return"string"==typeof t?s.ajax(t,{dataType:"json"}).done((e=this,function(t){return e.save(t)})):this.save(t);var e},h=v,y.prototype.init=function(){var t=this.context.getOpt("alias")||this.context.at.charCodeAt(0),e=this.context.getOpt("headerTpl");return e&&1===this.$el.children().length&&this.$el.prepend(e),this.$el.attr({id:"at-view-"+t})},y.prototype.destroy=function(){return this.$el.remove()},y.prototype.bindEvent=function(){var e,n=this.$el.find("ul"),i=0,r=0;return n.on("mousemove.atwho-view","li",function(t){if((i!==t.clientX||r!==t.clientY)&&(i=t.clientX,r=t.clientY,!(t=s(t.currentTarget)).hasClass("cur")))return n.find(".cur").removeClass("cur"),t.addClass("cur")}).on("click.atwho-view","li",(e=this,function(t){return n.find(".cur").removeClass("cur"),s(t.currentTarget).addClass("cur"),e.choose(t),t.preventDefault()}))},y.prototype.visible=function(){return s.expr.filters.visible(this.$el[0])},y.prototype.highlighted=function(){return 0<this.$el.find(".cur").length},y.prototype.choose=function(t){var e,n;return(e=this.$el.find(".cur")).length&&(n=this.context.insertContentFor(e),this.context._stopDelayedCall(),this.context.insert(this.context.callbacks("beforeInsert").call(this.context,n,e,t),e),this.context.trigger("inserted",[e,t]),this.hide(t)),this.context.getOpt("hideWithoutSuffix")?this.stopShowing=!0:void 0},y.prototype.reposition=function(t){var e=this.context.app.iframeAsRoot?this.context.app.window:window;return t.bottom+this.$el.height()-s(e).scrollTop()>s(e).height()&&(t.bottom=t.top-this.$el.height()),t.left>(e=s(e).width()-this.$el.width()-5)&&(t.left=e),e={left:t.left,top:t.bottom},null!=(t=this.context.callbacks("beforeReposition"))&&t.call(this.context,e),this.$el.offset(e),this.context.trigger("reposition",[e])},y.prototype.next=function(){var t=this.$el.find(".cur").removeClass("cur").next();return(t=t.length?t:this.$el.find("li:first")).addClass("cur"),t=(t=t[0]).offsetTop+t.offsetHeight+(t.nextSibling?t.nextSibling.offsetHeight:0),this.scrollTop(Math.max(0,t-this.$el.height()))},y.prototype.prev=function(){var t=this.$el.find(".cur").removeClass("cur").prev();return(t=t.length?t:this.$el.find("li:last")).addClass("cur"),t=(t=t[0]).offsetTop+t.offsetHeight+(t.nextSibling?t.nextSibling.offsetHeight:0),this.scrollTop(Math.max(0,t-this.$el.height()))},y.prototype.scrollTop=function(t){var e=this.context.getOpt("scrollDuration");return e?this.$elUl.animate({scrollTop:t},e):this.$elUl.scrollTop(t)},y.prototype.show=function(){var t;return this.stopShowing?void(this.stopShowing=!1):(this.visible()||(this.$el.show(),this.$el.scrollTop(0),this.context.trigger("shown")),(t=this.context.rect())?this.reposition(t):void 0)},y.prototype.hide=function(t,e){var n;if(this.visible())return isNaN(e)?(this.$el.hide(),this.context.trigger("hidden",[t])):(n=this,t=function(){return n.hide()},clearTimeout(this.timeoutID),this.timeoutID=setTimeout(t,e))},y.prototype.render=function(t){var e,n,i,r,o,a;if(s.isArray(t)&&0<t.length){for(this.$el.find("ul").empty(),e=this.$el.find("ul"),a=this.context.getOpt("displayTpl"),n=0,r=t.length;n<r;n++)i=t[n],i=s.extend({},i,{"atwho-at":this.context.at}),o=this.context.callbacks("tplEval").call(this.context,a,i,"onDisplay"),(o=s(this.context.callbacks("highlighter").call(this.context,o,this.context.query.text))).data("item-data",i),e.append(o);return this.show(),this.context.getOpt("highlightFirst")?e.find("li:first").addClass("cur"):void 0}this.hide()},p=y,f={load:function(t,e){return(t=this.controller(t))?t.model.load(e):void 0},isSelecting:function(){var t;return!(null==(t=this.controller())||!t.view.visible())},hide:function(){var t;return null!=(t=this.controller())?t.view.hide():void 0},reposition:function(){var t;return(t=this.controller())?t.view.reposition(t.rect()):void 0},setIframe:function(t,e){return this.setupRootElement(t,e),null},run:function(){return this.dispatch()},destroy:function(){return this.shutdown(),this.$inputor.data("atwho",null)}},s.fn.atwho=function(n){var i=arguments,r=null;return this.filter('textarea, input, [contenteditable=""], [contenteditable=true]').each(function(){var t,e;return(e=(t=s(this)).data("atwho"))||t.data("atwho",e=new o(this)),"object"!=T(n)&&n?f[n]&&e?r=f[n].apply(e,Array.prototype.slice.call(i,1)):s.error("Method "+n+" does not exist on jQuery.atwho"):e.reg(n.at,n)}),null!=r?r:this},s.fn.atwho.default={at:void 0,alias:void 0,data:null,displayTpl:"<li>${name}</li>",insertTpl:"${atwho-at}${name}",headerTpl:null,callbacks:n,functionOverrides:{},searchKey:"name",suffix:void 0,hideWithoutSuffix:!1,startWithSpace:!0,acceptSpaceBar:!1,highlightFirst:!0,limit:5,maxLen:20,minLen:0,displayTimeout:300,delay:null,spaceSelectsMatch:!1,tabSelectsMatch:!0,editableAtwhoQueryAttrs:{},scrollDuration:150,suspendOnComposing:!0,lookUpOnClick:!0},s.fn.atwho.debug=!1},"function"==typeof define&&define.amd?define(["jquery"],t):"object"==("undefined"==typeof exports?"undefined":T(exports))?module.exports=t(require("jquery")):t(jQuery),($=jQuery).fn.tipTip=function(t){var m,b,w,x=$.extend({activation:"hover",keepAlive:!1,maxWidth:"200px",edgeOffset:3,defaultPosition:"bottom",delay:400,fadeIn:200,fadeOut:200,attribute:"title",content:!1,enter:function(){},exit:function(){}},t);return $("#tiptip_holder").length<=0?((m=$('<div id="tiptip_holder"></div>')).css("max-width",x.maxWidth),b=$('<div id="tiptip_content"></div>'),w=$('<div id="tiptip_arrow"></div>'),$("body").append(m.html(b).prepend(w.html('<div id="tiptip_arrow_inner"></div>')))):(m=$("#tiptip_holder"),b=$("#tiptip_content"),w=$("#tiptip_arrow")),this.each(function(){function t(){x.enter.call(this),b.html(y),m.hide().removeAttr("class").css("margin","0"),w.removeAttr("style");var t=parseInt(v.offset().top),e=parseInt(v.offset().left),n=parseInt(v.outerWidth()),i=parseInt(v.outerHeight()),r=m.outerWidth(),o=m.outerHeight(),a=Math.round((n-r)/2),s=Math.round((i-o)/2),u=Math.round(e+a),l=Math.round(t+i+x.edgeOffset),c="",h="",p=Math.round(r-12)/2,f=("bottom"==x.defaultPosition?c="_bottom":"top"==x.defaultPosition?c="_top":"left"==x.defaultPosition?c="_left":"right"==x.defaultPosition&&(c="_right"),a+e<parseInt($(window).scrollLeft())),d=r+e>parseInt($(window).width()),n=(f&&a<0||"_right"==c&&!d||"_left"==c&&e<r+x.edgeOffset+5?(c="_right",h=Math.round(o-13)/2,p=-12,u=Math.round(e+n+x.edgeOffset),l=Math.round(t+s)):(d&&a<0||"_left"==c&&!f)&&(c="_left",h=Math.round(o-13)/2,p=Math.round(r),u=Math.round(e-(r+x.edgeOffset+5)),l=Math.round(t+s)),t+i+x.edgeOffset+o+8>parseInt($(window).height()+$(window).scrollTop())),d=t+i-(x.edgeOffset+o+8)<0;n||"_bottom"==c&&n||"_top"==c&&!d?("_top"==c||"_bottom"==c?c="_top":c+="_top",h=o,l=Math.round(t-(o+5+x.edgeOffset))):(d|("_top"==c&&d)||"_bottom"==c&&!n)&&("_top"==c||"_bottom"==c?c="_bottom":c+="_bottom",h=-12,l=Math.round(t+i+x.edgeOffset)),"_right_top"==c||"_left_top"==c?l+=5:"_right_bottom"!=c&&"_left_bottom"!=c||(l-=5),"_left_top"!=c&&"_left_bottom"!=c||(u+=5),w.css({"margin-left":p+"px","margin-top":h+"px"}),m.css({"margin-left":u+"px","margin-top":l+"px"}).attr("class","tip"+c),g&&clearTimeout(g),g=setTimeout(function(){m.stop(!0,!0).fadeIn(x.fadeIn)},x.delay)}function e(){x.exit.call(this),g&&clearTimeout(g),m.fadeOut(x.fadeOut)}var g,v=$(this),y=x.content||v.attr(x.attribute);""!=y&&(x.content||v.removeAttr(x.attribute),g=!1,"hover"==x.activation?(v.hover(function(){t()},function(){x.keepAlive||e()}),x.keepAlive&&m.hover(function(){},function(){e()})):"focus"==x.activation?v.focus(function(){t()}).blur(function(){e()}):"click"==x.activation&&(v.click(function(){return t(),!1}).hover(function(){},function(){x.keepAlive||e()}),x.keepAlive)&&m.hover(function(){},function(){e()}))})},function(){function t(){}function m(t){var e=T(t);return null!=t&&("object"==e||"function"==e)}function o(t){return null!=t&&"object"==T(t)}function n(t){if(!(e="symbol"==T(t))&&(e=o(t))){if(null==t)t=t===x?"[object Undefined]":"[object Null]";else if(v&&v in Object(t)){var e=f.call(t,v),n=t[v];try{t[v]=x;var i=!0}catch(t){}var r=d.call(t);i&&(e?t[v]=n:delete t[v]),t=r}else t=d.call(t);e="[object Symbol]"==t}return e}function b(t){if("number"==typeof t)return t;if(n(t))return i;if("string"!=typeof(t=m(t)?m(t="function"==typeof t.valueOf?t.valueOf():t)?t+"":t:t))return 0===t?t:+t;t=t.replace(r,"");var e=s.test(t);return e||u.test(t)?l(t.slice(2),e?2:8):a.test(t)?i:+t}function w(){return c.Date.now()}var x,i=NaN,r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt,e="object"==("undefined"==typeof self?"undefined":T(self))&&self&&self.Object===Object&&self,c="object"==("undefined"==typeof global?"undefined":T(global))&&global&&global.Object===Object&&global||e||Function("return this")(),h=(e="object"==("undefined"==typeof exports?"undefined":T(exports))&&exports&&!exports.nodeType&&exports)&&"object"==("undefined"==typeof module?"undefined":T(module))&&module&&!module.nodeType&&module,p=Object.prototype,f=p.hasOwnProperty,d=p.toString,g=c._,v=(p=c.Symbol)?p.toStringTag:x,$=Math.max,C=Math.min;t.debounce=function(i,r,t){function n(t){var e=u,n=l;return u=l=x,d=t,h=i.apply(n,e)}function o(t){var e=t-f;return t-=d,f===x||r<=e||e<0||v&&c<=t}function a(){if(o(n=w()))return s(n);var t=setTimeout,e=n-d,n=r-(n-f);e=v?C(n,c-e):n,p=t(a,e)}function s(t){return p=x,y&&u?n(t):(u=l=x,h)}function e(){var t=w(),e=o(t);if(u=arguments,l=this,f=t,e){if(p===x)return d=t=f,p=setTimeout(a,r),g?n(t):h;if(v)return p=setTimeout(a,r),n(f)}return p===x&&(p=setTimeout(a,r)),h}var u,l,c,h,p,f,d=0,g=!1,v=!1,y=!0;if("function"!=typeof i)throw new TypeError("Expected a function");return r=b(r)||0,m(t)&&(g=!!t.leading,c=(v="maxWait"in t)?$(b(t.maxWait)||0,r):c,y="trailing"in t?!!t.trailing:y),e.cancel=function(){p!==x&&clearTimeout(p),d=0,u=f=l=p=x},e.flush=function(){return p===x?h:s(w())},e},t.isObject=m,t.isObjectLike=o,t.isSymbol=n,t.noConflict=function(){return c._===this&&(c._=g),this},t.now=w,t.toNumber=b,t.VERSION="4.17.4","function"==typeof define&&"object"==T(define.amd)&&define.amd?(c._=t,define(function(){return t})):h?((h.exports=t)._=t,e._=t):c._=t}.call(window);var e,n,$,y,s,r,i,o,u,m,l,b,w,x,a,c,C,t=_.noConflict();function O(t){return t}function h(t){return!m(t)&&t instanceof Object}function p(t,n,i){return C(t,function(t,e){return t[n].apply(t,i||[])})}function f(t){var e={};return(t=i(t,e)).getType=function(){return"button"},t.$().on("change",function(t){e.publishChange(t,this)}),t}function d(t){var e={},n=i(t,e);return n.getType=function(){return"checkbox"},n.get=function(){var t=[];return n.$().filter(":checked").each(function(){t.push(s(this).val())}),t},n.set=function(t){t=m(t)?t:[t],n.$().each(function(){s(this).prop("checked",!1)}),b(t,function(t){n.$().filter('[value="'+t+'"]').prop("checked",!0)})},e.equalTo=o,n.$().change(function(t){e.publishChange(t,this)}),n}function g(t){return(t=u(t)).getType=function(){return"email"},t}function v(t){var e={},n=r(t,e);return n.getType=function(){return"file"},n.get=function(){return w(n.$().val().split("\\"))},n.clear=function(){this.$().each(function(){s(this).wrap("<form>").closest("form").get(0).reset(),s(this).unwrap()})},n.$().change(function(t){e.publishChange(t,this)}),n}function k(t){var e={};return(t=i(t,e)).getType=function(){return"hidden"},t.$().change(function(t){e.publishChange(t,this)}),t}function E(t){var e={},i=r(t,e);return i.getType=function(){return"file[multiple]"},i.get=function(){for(var t=i.$().get(0).files||[],e=[],n=0;n<(t.length||0);n+=1)e.push(t[n].name);return e},i.clear=function(){this.$().each(function(){s(this).wrap("<form>").closest("form").get(0).reset(),s(this).unwrap()})},i.$().change(function(t){e.publishChange(t,this)}),i}function S(t){var e={},n=i(t,e);return n.getType=function(){return"select[multiple]"},n.get=function(){return n.$().val()||[]},n.set=function(t){n.$().val(""===t?[]:m(t)?t:[t])},e.equalTo=o,n.$().change(function(t){e.publishChange(t,this)}),n}function R(t){return(t=u(t)).getType=function(){return"password"},t}function I(t){var e={},n=i(t,e);return n.getType=function(){return"radio"},n.get=function(){return n.$().filter(":checked").val()||null},n.set=function(t){t?n.$().filter('[value="'+t+'"]').prop("checked",!0):n.$().each(function(){s(this).prop("checked",!1)})},n.$().change(function(t){e.publishChange(t,this)}),n}function A(t){var e={};return(t=i(t,e)).getType=function(){return"range"},t.$().change(function(t){e.publishChange(t,this)}),t}function P(t){var e={};return(t=i(t,e)).getType=function(){return"select"},t.$().change(function(t){e.publishChange(t,this)}),t}function q(t){var e={};return(t=i(t,e)).getType=function(){return"textarea"},t.$().on("change keyup keydown",function(t){e.publishChange(t,this)}),t}function j(t){return(t=u(t)).getType=function(){return"url"},t}function D(t){function e(e,t){(h(t)?t:o.find(t)).each(function(){var t=s(this).attr("name");r[t]=a[e]({$:s(this)})})}function n(e,t){var n=[],i=h(t)?t:o.find(t);h(t)?r[i.attr("name")]=a[e]({$:i}):(i.each(function(){-1===l(n,s(this).attr("name"))&&n.push(s(this).attr("name"))}),b(n,function(t){r[t]=a[e]({$:o.find('input[name="'+t+'"]')})}))}var r={},o=t.$,a=t.constructorOverride||{button:f,text:u,url:j,email:g,password:R,range:A,textarea:q,select:P,"select[multiple]":S,radio:I,checkbox:d,file:v,"file[multiple]":E,hidden:k};return o.is("input, select, textarea")?o.is('input[type="button"], button, input[type="submit"]')?e("button",o):o.is("textarea")?e("textarea",o):o.is('input[type="text"]')||o.is("input")&&!o.attr("type")?e("text",o):o.is('input[type="password"]')?e("password",o):o.is('input[type="email"]')?e("email",o):o.is('input[type="url"]')?e("url",o):o.is('input[type="range"]')?e("range",o):o.is("select")?o.is("[multiple]")?e("select[multiple]",o):e("select",o):o.is('input[type="file"]')?o.is("[multiple]")?e("file[multiple]",o):e("file",o):o.is('input[type="hidden"]')?e("hidden",o):o.is('input[type="radio"]')?n("radio",o):o.is('input[type="checkbox"]')?n("checkbox",o):e("text",o):(e("button",'input[type="button"], button, input[type="submit"]'),e("text",'input[type="text"]'),e("password",'input[type="password"]'),e("email",'input[type="email"]'),e("url",'input[type="url"]'),e("range",'input[type="range"]'),e("textarea","textarea"),e("select","select:not([multiple])"),e("select[multiple]","select[multiple]"),e("file",'input[type="file"]:not([multiple])'),e("file[multiple]",'input[type="file"][multiple]'),e("hidden",'input[type="hidden"]'),n("radio",'input[type="radio"]'),n("checkbox",'input[type="checkbox"]')),r}MyListing.Helpers.debounce=t.debounce,y=jQuery,m=function(t){return y.isArray(t)},l=function(t,e){return y.inArray(e,t)},b=function(t,e){for(var n in t)t.hasOwnProperty(n)&&e(t[n],n,t)},w=function(t){return t[t.length-1]},x=function(t){return Array.prototype.slice.call(t)},a=function(t,i){var r=[];return b(t,function(t,e,n){r.push(i(t,e,n))}),r},c=function(t,i,r){var o={};return b(t,function(t,e,n){e=r?r(e,t):e,o[e]=i(t,e,n)}),o},C=function(t,e,n){return m(t)?a(t,e):c(t,e,n)},s=jQuery,r=function(t,i){r={},(e=e||{}).publish=function(t,e){b(r[t],function(t){t(e)})},e.subscribe=function(t,e){r[t]=r[t]||[],r[t].push(e)},e.unsubscribe=function(n){b(r,function(t){var e=l(t,n);-1!==e&&t.splice(e,1)})};var e,r,o,a=e,n=t.$;return a.getType=function(){throw'implement me (return type. "text", "radio", etc.)'},a.$=function(t){return t?n.find(t):n},a.disable=function(){a.$().prop("disabled",!0),a.publish("isEnabled",!1)},a.enable=function(){a.$().prop("disabled",!1),a.publish("isEnabled",!0)},i.equalTo=function(t,e){return t===e},i.publishChange=function(t,e){var n=a.get();i.equalTo(n,o)||a.publish("change",{e:t,domElement:e}),o=n},a},i=function(t,e){var n=r(t,e);return n.get=function(){return n.$().val()},n.set=function(t){n.$().val(t)},n.clear=function(){n.set("")},e.buildSetter=function(e){return function(t){e.call(n,t)}},n},o=function(t,e){t=m(t)?t:[t],e=m(e)?e:[e];var n=!0;return t.length!==e.length?n=!1:b(t,function(t){-1===l(e,t)&&(n=!1)}),n},u=function(t){var e={},t=i(t,e);return t.getType=function(){return"text"},t.$().on("change keyup keydown",function(t){e.publishChange(t,this)}),t},s.fn.inputVal=function(t){var e=s(this),n=D({$:e});return e.is("input, textarea, select")?void 0===t?n[e.attr("name")].get():(n[e.attr("name")].set(t),e):void 0===t?p(n,"get"):(b(t,function(t,e){n[e].set(t)}),e)},s.fn.inputOnChange=function(e){var t=s(this),n=D({$:t});return b(n,function(t){t.subscribe("change",function(t){e.call(t.domElement,t.e)})}),t},s.fn.inputDisable=function(){var t=s(this);return p(D({$:t}),"disable"),t},s.fn.inputEnable=function(){var t=s(this);return p(D({$:t}),"enable"),t},s.fn.inputClear=function(){var t=s(this);return p(D({$:t}),"clear"),t},y.fn.repeaterVal=function(){var t,i;return function n(t){if(1===t.length&&(0===t[0].key.length||1===t[0].key.length&&!t[0].key[0]))return t[0].val;b(t,function(t){t.head=t.key.shift()});e={},b(t,function(t){e[t.head]||(e[t.head]=[]),e[t.head].push(t)});var i,e,r=e;return/^[0-9]+$/.test(t[0].head)?(i=[],b(r,function(t){i.push(n(t))})):(i={},b(r,function(t,e){i[e]=n(t)})),i}((t=y(this).inputVal(),i=[],b(t,function(t,e){var n=[];"undefined"!==e&&(n.push(e.match(/^[^\[]*/)[0]),n=n.concat(C(e.match(/\[[^\]]*\]/g),function(t){return t.replace(/[\[\]]/g,"")})),i.push({val:t,key:n}))}),i))},y.fn.repeater=function(g){var v;return g=g||{},y(this).each(function(){function n(){var t=s.data("repeater-list");return g.$parent?g.$parent.data("item-name")+"["+t+"]":t}function a(t,r,o){t.each(function(n){var i=y(this);i.data("item-name",r+"["+n+"]"),u(i.find("[name]"),o).each(function(){var t=y(this),e=t.attr("name").match(/\[[^\]]+\]/g),e=e?w(e).replace(/\[|\]/g,""):t.attr("name"),e=r+"["+n+"]["+e+"]"+(t.is(":checkbox")||t.attr("multiple")?"[]":"");t.attr("name",e),h(o,i,function(t){var e=y(this);a(u(e.find("[data-repeater-item]"),t.repeaters||[]),r+"["+n+"]["+e.find("[data-repeater-list]").first().data("repeater-list")+"]",t.repeaters)})})}),s.find("input[name][checked]").removeAttr("checked").prop("checked",!0)}var t=y(this),i=g.show||function(){y(this).show()},e=g.hide||function(t){t()},s=t.find("[data-repeater-list]").first(),u=function(t,n){return t.filter(function(){return!n||0===y(this).closest((e="selector",C(n,function(t){return t[e]}).join(","))).length;var e})},r=function(){return u(s.find("[data-repeater-item]"),g.repeaters)},o=s.find("[data-repeater-item]").first().clone().hide(),l=u(u(y(this).find("[data-repeater-item]"),g.repeaters).first().find("[data-repeater-delete]"),g.repeaters),c=(g.isFirstItemUndeletable&&l&&l.remove(),function(t){g.repeaters&&t.each(function(){var e=y(this);b(g.repeaters,function(t){e.find(t.selector).repeater(function(){var n={};return b(x(arguments),function(t){b(t,function(t,e){n[e]=t})}),n}(t,{$parent:e}))})})}),h=function(t,e,n){t&&b(t,function(t){n.call(e.find(t.selector)[0],t)})},p=(a(r(),n(),g.repeaters),c(r()),g.initEmpty&&r().remove(),g.ready&&g.ready(function(){a(r(),n(),g.repeaters)}),function(t,e){s.append(t),a(r(),n(),g.repeaters),t.find("[name]").each(function(){y(this).inputClear()}),d(t,e||g.defaultValues,g.repeaters)}),f=function(t){var e=o.clone();p(e,t),g.repeaters&&c(e),i.call(e.get(0))};function d(t,e,n){var i,r,o,a;(e||g.defaultValues)&&(i={},u(t.find("[name]"),n).each(function(){var t=y(this).attr("name").match(/\[([^\]]*)(\]|\]\[\])$/)[1];i[t]=y(this).attr("name")}),t.inputVal(C((r=e||g.defaultValues,o=function(t,e){return i[e]},m(r)?(a=[],b(r,function(t,e,n){o(t,e,n)&&a.push(t)})):(a={},b(r,function(t,e,n){o(t,e,n)&&(a[e]=t)})),a),O,function(t){return i[t]}))),h(n,t,function(i){var r=y(this);u(r.find("[data-repeater-item]"),i.repeaters).each(function(){var n,t=r.find("[data-repeater-list]").data("repeater-list");e&&e[t]?(n=y(this).clone(),r.find("[data-repeater-item]").remove(),b(e[t],function(t){var e=n.clone();d(e,t,i.repeaters||[]),r.find("[data-repeater-list]").append(e)})):d(y(this),i.defaultValues,i.repeaters||[])})})}v=function(t){r().remove(),b(t,f)},u(t.find("[data-repeater-create]"),g.repeaters).click(function(){f()}),s.on("click","[data-repeater-delete]",function(){var t=y(this).closest("[data-repeater-item]").get(0);e.call(t,function(){y(t).remove(),a(r(),n(),g.repeaters)})})}),this.setList=v,this}});
